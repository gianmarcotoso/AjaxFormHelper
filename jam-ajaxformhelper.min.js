(function(e){var t={init:function(t){e(this).ajaxFormHelper("update",t);e(this).submit(function(){var t=e(this).data("ajaxFormHelper").data;var n=e(this).ajaxFormHelper("validate");if(n===true){if(t.validationSuccess)t.validationSuccess.call(this);e(this).ajaxFormHelper("upload")}else{if(t.validationFailed)t.validationFailed.call(this,n)}return false});e('input[data-role="abort"]',e(this)).click(function(){e(this).ajaxFormHelper("abort")}.bind(this))},validate:function(){var t=e(this).data("ajaxFormHelper").data;var n=new Array;for(var r in t.validateFields){var i=t.validateFields[r].input;if(t.validateFields[r].validate&&!t.validateFields[r].validate(e(i).attr("type")=="file"?i.files:e(i).val()))n.push(i)}return n.length==0?true:n},update:function(t){if(typeof t==="undefined")t={};oldData=e(this).data("ajaxFormHelper")?e(this).data("ajaxFormHelper").data:{};var n={method:t.method||oldData.method||e(this).attr("method"),url:t.url||oldData.url||e(this).attr("action"),dataType:t.dataType||oldData.dataType||e(this).attr("data-type")||"json",success:t.success||oldData.success||window[e(this).attr("data-success")]||function(t,n,r){e(this).ajaxFormHelper("success",t,n,r)},progress:t.progress||oldData.progress||window[e(this).attr("data-progress")]||function(t){e(this).ajaxFormHelper("progress",t)},error:t.error||oldData.error||window[e(this).attr("data-error")]||function(t){e(this).ajaxFormHelper("error",t)},beforeSend:t.beforeSend||oldData.beforeSend||window[e(this).attr("data-beforeSend")]||function(){e(this).ajaxFormHelper("beforeSend")},validationFailed:t.validationFailed||oldData.validationFailed||window[e(this).attr("data-validationFailed")]||null,validationSuccess:t.validationSuccess||oldData.validationSuccess||window[e(this).attr("data-validationSuccess")]||null,validateFields:t.validateFields||oldData.validateFields||null};if(!n.validateFields){n.validateFields=new Array;var r=e("input,textarea,select",e(this));e.each(r,function(){if(!e(this).attr("data-validate"))return;n.validateFields[e(this).attr("name")]={validate:window[e(this).attr("data-validate")].bind(this),input:this}})}e(this).data("ajaxFormHelper",{target:this,data:n})},upload:function(){var t=e(this).data("ajaxFormHelper").data;var n=e('input[type="file"]',e(this));var r=new FormData;e.each(e('input[type="file"]',e(this)),function(){var t=e(this)[0].files;var n=new Array;var i=e(this).attr("name");if(t.length==1){r.append(i,t[0])}else{for(var s=0;s<t.length;s++){r.append(i+"["+s+"]",t[s])}}});var i=e(this).serializeArray();for(var s in i){r.append(i[s].name,i[s].value)}var o=e.ajax({url:t.url,type:t.method,data:r,dataType:t.dataType,processData:false,contentType:false,beforeSend:t.beforeSend.bind(this),success:t.success.bind(this),error:t.error.bind(this),progress:t.progress.bind(this)});e(this).data("ajaxFormHelper",{target:this,data:t,request:o})},abort:function(){var t=e(this).data("ajaxFormHelper").request;if(t){t.abort()}},beforeSend:function(){},progress:function(e){},error:function(e){},success:function(e,t,n){}};e.fn.ajaxFormHelper=function(n){if(t[n]){return t[n].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof n==="object"||!n){return t.init.apply(this,arguments)}else{e.error("Method "+n+" does not exist on jQuery.ajaxFormHelper")}}})(jQuery);$(document).ready(function(){$.each($('form[data-ajax="true"]'),function(){$(this).ajaxFormHelper()})});(function(e,t,n){var r=e.ajaxSettings.xhr;e.ajaxSettings.xhr=function(){var e=r();if(e instanceof t.XMLHttpRequest){e.addEventListener("progress",this.progress,false)}if(e.upload){e.upload.addEventListener("progress",this.progress,false)}return e}})(jQuery,window)